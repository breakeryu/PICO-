PICO-MAGIX通讯协议（初稿）



# 第一章：综述

PICO_MAGIX通讯协议文件是总括上位机和下位机定义的通讯方式，所有的通讯指令都在本文件中包括。

本协议参考MODBUS协议进行编写。

本协议软件参考木南协议进行编写。

https://github.com/foxclever/Modbus

本协议参考GESHE测控大师软件编写。

http://www.geshe.com/zh-cn/

# 第二章：通讯协议总括

本章将总括使用的ModBus-RTU通讯协议。

## 2.1 ModBus-RTU上位机通信协议格式

Modbus®RTU协议，目前工作支持以下功能码：01、02、03、04、05、06、15、16。

**根据功能码长度， 定义01、02、03、04、05、06为*一类功能码*；定义15、16为*二类功能码*。**

下面介绍上位机发送/主站发送请求帧格式。

- ### 一类功能码通讯协议格式

  | 字节段功能 | 节点地址 | 功能码 | 起始地址 | 起始地址 | 寄存器数量 | 寄存器数量 | 校验码 | 校验码 |
  | ---------- | -------- | ------ | -------- | -------- | ---------- | ---------- | ------ | ------ |
  | 字节顺序   | 0        | 1      | 2        | 3        | 4          | 5          | 6      | 7      |

  > 注意：一类功能码：01、02、03、04、05、06。
  >
  > 一类码主站发送协议例图：
  >
  > ![image-20220306104617756](C:\Users\iccad\AppData\Roaming\Typora\typora-user-images\image-20220306104617756.png)

- ### 二类功能码通讯协议格式

| 字节段功能 | 节点地址 | 功能码 | 起始地址 | 起始地址 | 寄存器数量 | 寄存器数量 | 字节数 | 寄存器值 | 寄存器值 | 校验码 | 校验码 |
| ---------- | -------- | ------ | -------- | -------- | ---------- | ---------- | ------ | -------- | -------- | ------ | ------ |
| 字节顺序   | 0        | 1      | 2        | 3        | 4          | 5          | 6      | 7        | 8        | 9      | 10     |

> 注意：二类功能码：15、16。十六进制0x0F、0x10。
>
> 二类码主站发送协议例图：
>
> ![image-20220306104731444](C:\Users\iccad\AppData\Roaming\Typora\typora-user-images\image-20220306104731444.png)







